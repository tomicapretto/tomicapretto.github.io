<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Tomás Capretto: How to generate bingo cards in R</title>

<meta property="description" itemprop="description" content="A walkthrough the process of understanding how bingo cards are composed&#10;and a set of R functions that let us generate random bingo cards and print them&#10;in a nice looking .pdf output."/>

<link rel="canonical" href="https://tomicapretto.github.io/posts/2020-11-03-bingo-cards-in-r/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2020-11-03"/>
<meta property="article:created" itemprop="dateCreated" content="2020-11-03"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Tomás Capretto: How to generate bingo cards in R"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A walkthrough the process of understanding how bingo cards are composed&#10;and a set of R functions that let us generate random bingo cards and print them&#10;in a nice looking .pdf output."/>
<meta property="og:url" content="https://tomicapretto.github.io/posts/2020-11-03-bingo-cards-in-r/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Tomás Capretto"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Tomás Capretto: How to generate bingo cards in R"/>
<meta property="twitter:description" content="A walkthrough the process of understanding how bingo cards are composed&#10;and a set of R functions that let us generate random bingo cards and print them&#10;in a nice looking .pdf output."/>
<meta property="twitter:url" content="https://tomicapretto.github.io/posts/2020-11-03-bingo-cards-in-r/"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","date","output","description","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["How to generate bingo cards in R"]},{"type":"character","attributes":{},"value":["2020-11-03"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["A walkthrough the process of understanding how bingo cards are composed\nand a set of R functions that let us generate random bingo cards and print them\nin a nice looking .pdf output."]},{"type":"character","attributes":{},"value":["https://tomicapretto.github.io/posts/2020-11-03-bingo-cards-in-r/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bingo-cards-in-r_files/anchor-4.2.2/anchor.min.js","bingo-cards-in-r_files/bowser-1.9.3/bowser.min.js","bingo-cards-in-r_files/distill-2.2.21/template.v2.js","bingo-cards-in-r_files/header-attrs-2.11/header-attrs.js","bingo-cards-in-r_files/jquery-3.6.0/jquery-3.6.0.js","bingo-cards-in-r_files/jquery-3.6.0/jquery-3.6.0.min.js","bingo-cards-in-r_files/jquery-3.6.0/jquery-3.6.0.min.map","bingo-cards-in-r_files/popper-2.6.0/popper.min.js","bingo-cards-in-r_files/tippy-6.2.7/tippy-bundle.umd.min.js","bingo-cards-in-r_files/tippy-6.2.7/tippy-light-border.css","bingo-cards-in-r_files/tippy-6.2.7/tippy.css","bingo-cards-in-r_files/tippy-6.2.7/tippy.umd.min.js","bingo-cards-in-r_files/webcomponents-2.0.0/webcomponents.js","files/bingo_card_own.PNG","files/bingo_card.png","files/bingo_strip.PNG","files/invalid_row_1.PNG","files/invalid_row_2.PNG","files/strips.pdf","files/valid_card_1.PNG","files/valid_row_1.PNG","files/valid_row_2.PNG"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-217292110-1"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-217292110-1');
</script>
<style type="text/css">
@import url("https://fonts.googleapis.com/css2?family=Sanchez");
@import url("https://fonts.googleapis.com/css2?family=Lato");

html {
  /*-- Main font colors --*/
  --header-color: hsl(210, 10%, 40%);
  --link-dark: hsl(210, 60%, 40%);
  --link: hsl(200, 60%, 50%);
  --link-background: hsl(200deg 60% 50% / 10%);
  --dark: hsl(210, 10%, 25%);

  /* Custom fonts */
  --heading-font: "Sanchez", helvetica, arial, sans-serif;
  --nav-font: "Lato", helvetica, arial, sans-serif;
}

p a {
  border-bottom: 0;
  background-image: linear-gradient(currentColor, currentColor);
  background-size: 100% 2.4px;
  background-position: 0% 100%;
  background-repeat: no-repeat;
  border-radius: 1px;
  color: var(--link);
  font-size: 1.1em;
  text-decoration: none;
}

p a:hover {
  border-bottom: 0;
  background-image: linear-gradient(currentColor, currentColor);
  background-size: 100% 2.4px;
  background-position: 0% 100%;
  background-repeat: no-repeat;
  border-radius: 1px;
  color: var(--link-dark);
  text-decoration: none;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  color: var(--header-color);
  font-family: var(--heading-font);
}

d-article h1,
h2,
h3,
h4,
h5,
h6 {
  font-weight: 400;
}

pre.sourceCode {
  background: #f5f2f0;
  border-radius: 3px;
  border: solid 1px hsl(200, 20%, 88%);
  padding: 1em;
}

.distill-site-header .title {
  font-family: var(--nav-font);
  font-size: 24px;
  min-width: 150px;
}

.distill-site-nav {
  background-color: var(--dark);
  font-weight: 400;
}

.distill-site-nav a {
  font-family: var(--nav-font);
  font-size: 22px;
  text-decoration: none;
}

.posts-list .post-preview h2 {
  font-family: var(--heading-font);
  font-size: 32px;
  font-style: normal;
  font-weight: 400;
  line-height: 1.2em;
  margin: 0 0 6px 0;
}

/* Inline code formatting */
p code, li code {
  color: #fff;
  font-size: 1.0em;
  background: hsl(200deg 60% 60% / 100%);
  border-radius: 3px;
  padding: 0 3px;
  margin: 0 3px;
  word-wrap: break-word;
  letter-spacing: normal;
}

/* Button font is the same than headers */

button {
  font-family: var(--heading-font);
}

/* Sticky footer */

body {
  display: grid;
  min-height: 100vh;
  grid-template-rows: auto auto 1fr;
}

.distill-site-footer {
  align-self: end;
}
</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"How to generate bingo cards in R","description":"A walkthrough the process of understanding how bingo cards are composed\nand a set of R functions that let us generate random bingo cards and print them\nin a nice looking .pdf output.","authors":[],"publishedDate":"2020-11-03T00:00:00.000-03:00"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Tomás Capretto</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../posts.html">Posts</a>
<a href="../../about.html">About</a>
<a href="https://github.com/tomicapretto">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>How to generate bingo cards in R</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A walkthrough the process of understanding how bingo cards are composed and a set of R functions that let us generate random bingo cards and print them in a nice looking .pdf output.</p></p>
</div>


<div class="d-article">
<p>Hello wor… Well, my first hello world post appeared about a year ago, but this site had the same fate as many of my othe side-projects… abandonment.</p>
<p>Until now.</p>
<h2 id="introduction">Introduction</h2>
<p>Today I’m going to show you how I came up with “an algorithm” to generate random bingo cards and some utility functions to print them on a nice looking (?) .pdf file.</p>
<p>First of all, what type of bingo card I’m referring to? As an Argentine, the only bingo cards I’ve ever heard of are bingo cards like this one</p>
<center>
<figure>
<img src="files/bingo_card.png" alt="Example bingo card from bingo.es" /><figcaption aria-hidden="true">Example bingo card from bingo.es</figcaption>
</figure>
</center>
<p>It contains fifteen numbers from 1 to 90 that are divided in three rows and nine columns. The first column contains numbers between 1 and 9, the second column numbers between 10 and 20, and so on until the last column that contains numbers between 80 and 90. The type of bingo that you play with this bingo card is known as the <a href="https://en.wikipedia.org/wiki/Bingo_(British_version)">90-ball bingo game</a> or British bingo. As I said, this is the only version I knew before this project <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and I think it is the only bingo version you’ll find here in Argentina (I also bet you’ll find some fellow Argentine confirming this a national invention).</p>
<p>So, if you entered this post thinking you’ll find how to print those bingo cards that are popular in places like United States, I’m sorry, this is not for you <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Fortunately, other people have invented a tool for you even before I wondered how to generate bingo cards. If you are interested, have a look at <a href="https://github.com/jennybc/bingo">this package</a> and the Shiny app introduced there.</p>
<p>Now, let’s go back to our business.</p>
<p>Anyone who has gone to one of those events where people gather to play bingo <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> knows that bingo cards don’t usually come separated in individual pieces of paper. Sellers usually have strips of six bingo cards in their hands. In some events, you can buy bingo cards directly. In others, you have to buy the entire strip.</p>
<p>Since this is a 90-ball bingo game and each card contains fifteen numbers, six bingo cards with no repeated numbers is all we need to have all the numbers of the game in a single strip. You see where it is going?. Yes, we won’t generate isolated cards, we’ll generate entire strips. This is how a bingo strip looks like (just imagine them vertically stacked on a single strip)</p>
<center>
<figure>
<img src="files/bingo_strip.PNG" alt="Example bingo strip from bingo.es" /><figcaption aria-hidden="true">Example bingo strip from bingo.es</figcaption>
</figure>
</center>
<h2 id="valid-cards-and-valid-strips">Valid cards and valid strips</h2>
<p>Bingo cards are not just a bunch of numbers thrown at a piece of paper. All valid strips are composed of six valid cards each made of three valid rows. But not any combinations of three valid rows make up a valid card nor any combinations of six valid cards make up a valid strip. What a shame!</p>
<p>But what is a valid row, a valid card, a va… whatever. Let’s just get to the point and list the rules that will govern how we generate bingo cards.</p>
<h3 id="valid-row">Valid row</h3>
<p>We’re going to think that a row is a numeric vector of length nine where some elements are empty and some are filled with numbers.</p>
<ul>
<li>Exactly five elements are numbers, and four are empty.</li>
<li>There can’t be more than two consecutive empty elements, which is equivalent to having at most three consecutive numbers.</li>
</ul>
<p><strong>Example valid rows</strong></p>
<center>
<p><img src="files/valid_row_1.PNG" /> <img src="files/valid_row_2.PNG" /></p>
</center>
<p><strong>Example invalid rows</strong></p>
<center>
<p><img src="files/invalid_row_1.PNG" /> <img src="files/invalid_row_2.PNG" /></p>
</center>
<h3 id="valid-card">Valid card</h3>
<p>We can think that a bingo card is a matrix of three rows and nine columns. Each row must be a valid row as specified in the previous point, plus</p>
<ul>
<li>No column can be completely empty.</li>
<li>No column can be completely filled with numbers.</li>
<li>Numbers are sorted in ascending order within columns.</li>
</ul>
<p><strong>Example valid card</strong></p>
<center>
<p><img src="files/valid_card_1.PNG" /></p>
</center>
<h3 id="valid-strip">Valid strip</h3>
<p>A valid strip contains six valid cards that satisfy the following conditions</p>
<ul>
<li>The first column must have <strong>nine</strong> numbers and nine empty slots.</li>
<li>Columns 2 to 8 must have <strong>ten</strong> numbers and eight empty slots.</li>
<li>Column 9 must have <strong>eleven</strong> numbers and seven empty slots.</li>
</ul>
<p>In total, we have <span class="math inline">\(6\times3\times9 = 162\)</span> slots in a strip.<br />
90 of them are filled with numbers, 72 are not.</p>
<h2 id="sample-this-sample-that-ive-got-no-need-to-compute-them-all">Sample this, sample that, I’ve got no need to compute them all<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></h2>
<p>One approach to generate bingo cards would be to get all possible combinations of row layouts, bingo layouts, number arrangements, etc. But the <a href="https://math.stackexchange.com/questions/510693/how-many-90-ball-bingo-cards-are-there">number of cards you could generate is huge</a> and the task wouldn’t be easy at all.</p>
<p>The approach used here is one that mixes some simple combinatorics and random sampling. We use permutations to compute all the possible row layouts. Then, we sample rows to create cards and sample cards to create strips<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<p>First of all, we are going to find valid layouts (i.e. the skeleton of our bingo strips). Once we have them, we are going to fill them with numbers.</p>
<h3 id="finding-valid-rows">Finding valid rows</h3>
<p>If we represent empty slots with a 0 and filled slots with a 1, getting all permutations between four 0s and five 1s is as simple as calling <code>combinat::permn(c(rep(0, 4), rep(1, 5)))</code>. However, this is not what we want because not all the returned layouts are valid rows. We need to select only those row layouts that are valid in a bingo card.</p>
<p>The following function, <code>find_window()</code>, receives a numeric vector <code>x</code> and looks for find windows of length <code>width</code> where all the elements are equal to <code>what</code>. If such a window is found, the function returns <code>TRUE</code>, otherwise it returns <code>FALSE</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>find_window</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>width</span>, <span class='va'>what</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>width</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>i</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span> <span class='op'>+</span> <span class='va'>width</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>==</span> <span class='va'>what</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Then we write a function called <code>get_rows()</code> that generates all the possible row layouts and uses <code>find_window()</code> to select the layouts that satisfy our conditions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>get_rows</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># Get all row layouts</span>
  <span class='va'>rows</span> <span class='op'>=</span> <span class='fu'>combinat</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/combinat/man/permn.html'>permn</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='co'># Keep rows with at most two consecutive empty slots</span>
  <span class='va'>rows</span> <span class='op'>=</span> <span class='va'>rows</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>vapply</a></span><span class='op'>(</span><span class='va'>rows</span>, <span class='va'>find_window</span>, <span class='fu'><a href='https://rdrr.io/r/base/logical.html'>logical</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>, <span class='fl'>2</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>]</span>
  <span class='co'># Keep rows with at most three consecutive filled slots</span>
  <span class='va'>rows</span> <span class='op'>=</span> <span class='va'>rows</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>vapply</a></span><span class='op'>(</span><span class='va'>rows</span>, <span class='va'>find_window</span>, <span class='fu'><a href='https://rdrr.io/r/base/logical.html'>logical</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>, <span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>rows</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h3 id="sampling-valid-cards">Sampling valid cards</h3>
<p>We noted that a valid card is made of three valid rows, but not all combinations of three valid rows make up a valid card. What if we sample three row layouts and keep/discard the combination based on whether they make up a valid card or not? We can repeat this until we have some desired number of card layours. The process is as follows</p>
<ul>
<li>Let <span class="math inline">\(N\)</span> be the number of cards we want to generate.</li>
<li>While the number of cards generated is smaller than <span class="math inline">\(N\)</span>, do:
<ul>
<li>Sample three rows and make up the card.</li>
<li>Count the number of filled slots per column.</li>
<li>If all the counts are between 1 and 3, keep the card, else discard it.</li>
</ul></li>
</ul>
<p>Once we’re done, we end up with <span class="math inline">\(N\)</span> bingo card layouts that are valid in terms of our requirements above.</p>
<p>This idea is implemented in a function called <code>get_cards()</code>. It receives the rows we generate with <code>get_rows()</code> and the number of card layouts we want to generate. Finally it returns a list whose elements are vectors of length 3 with the row indexes<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>get_cards</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>rows</span>, <span class='va'>cards_n</span> <span class='op'>=</span> <span class='fl'>2000</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>rows_n</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>rows</span><span class='op'>)</span>
  <span class='va'>cards</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"list"</span>, <span class='va'>cards_n</span><span class='op'>)</span>
  
  <span class='va'>attempts</span> <span class='op'>=</span> <span class='fl'>0</span>
  <span class='va'>card_idx</span> <span class='op'>=</span> <span class='fl'>0</span>
  
  <span class='kw'>while</span> <span class='op'>(</span><span class='va'>card_idx</span> <span class='op'>&lt;</span> <span class='va'>cards_n</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>attempts</span> <span class='op'>=</span> <span class='va'>attempts</span> <span class='op'>+</span> <span class='fl'>1</span>
    <span class='co'># Sample three rows</span>
    <span class='va'>row_idxs</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>rows_n</span>, <span class='fl'>3</span><span class='op'>)</span>
    <span class='va'>mm</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>rows</span><span class='op'>[</span><span class='va'>row_idxs</span><span class='op'>]</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>9</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
    <span class='va'>col_sums</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span><span class='op'>(</span><span class='va'>mm</span><span class='op'>)</span>
    
    <span class='co'># Select valid cards.</span>
    <span class='co'># These have between 1 and 3 numbers per column.</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>col_sums</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>&amp;&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>col_sums</span> <span class='op'>!=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>card_idx</span> <span class='op'>=</span> <span class='va'>card_idx</span> <span class='op'>+</span> <span class='fl'>1</span>
      <span class='va'>cards</span><span class='op'>[[</span><span class='va'>card_idx</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>row_idxs</span>, <span class='va'>col_sums</span><span class='op'>)</span>
    <span class='op'>}</span>

    <span class='co'># Print message every 1000 attempts</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>attempts</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='fl'>1000</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"Attempt "</span>, <span class='va'>attempts</span>, <span class='st'>" | Cards built:"</span>, <span class='va'>card_idx</span>, <span class='st'>"\n"</span><span class='op'>)</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  <span class='co'># Check duplicates</span>
  <span class='va'>dups</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>cards</span>, <span class='va'>`[[`</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"There are "</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dups</span><span class='op'>)</span>, <span class='st'>" duplicated cards."</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>cards</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h3 id="sampling-valid-strips">Sampling valid strips</h3>
<p>This is the much like what we did above, with two differences.<br />
Instead of sampling three row layouts, we sample six card layouts. Instead of checking if the number of filled slots per column are between 1 and 3, we check if they match a number between 9 and 11 specific to each of them.</p>
<p>Then, we have <code>get_strips()</code>. It receives a list called <code>cards</code> where each element contains the three row indexes corresponding to each card layout. <code>rows</code> is a list of row layouts and <code>strips_n</code> controls how many strip layouts we want to generate.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>get_strips</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>cards</span>, <span class='va'>rows</span>, <span class='va'>strips_n</span> <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>valid_counts</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>9</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>7</span><span class='op'>)</span>, <span class='fl'>11</span><span class='op'>)</span>

  <span class='va'>cards_n</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>cards</span><span class='op'>)</span>
  <span class='va'>strips</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"list"</span>, <span class='va'>strips_n</span><span class='op'>)</span>
  
  <span class='va'>attempts</span> <span class='op'>=</span> <span class='fl'>0</span>
  <span class='va'>strip_idx</span> <span class='op'>=</span> <span class='fl'>0</span>
  
  <span class='kw'>while</span> <span class='op'>(</span><span class='va'>strip_idx</span> <span class='op'>&lt;</span> <span class='va'>strips_n</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>attempts</span> <span class='op'>=</span> <span class='va'>attempts</span> <span class='op'>+</span> <span class='fl'>1</span>
    
    <span class='co'># Sample 6 cards</span>
    <span class='va'>cards_idxs</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>cards_n</span>, <span class='fl'>6</span><span class='op'>)</span>
    <span class='va'>strip</span> <span class='op'>=</span> <span class='va'>cards</span><span class='op'>[</span><span class='va'>cards_idxs</span><span class='op'>]</span>
    
    <span class='co'># Contains column counts by card</span>
    <span class='va'>card_counts</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>strip</span>, <span class='va'>`[[`</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>, 
      ncol <span class='op'>=</span> <span class='fl'>9</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span>
    <span class='op'>)</span>
    
    <span class='co'># Check if strip column counts are valid</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span><span class='op'>(</span><span class='va'>card_counts</span><span class='op'>)</span> <span class='op'>==</span> <span class='va'>valid_counts</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>strip_idx</span> <span class='op'>=</span> <span class='va'>strip_idx</span> <span class='op'>+</span> <span class='fl'>1</span>
      <span class='co'># Get row indexes contained in the selected card indexes</span>
      <span class='va'>rows_idxs</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>cards</span><span class='op'>[</span><span class='va'>cards_idxs</span><span class='op'>]</span>, <span class='va'>`[[`</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
      <span class='va'>strips</span><span class='op'>[[</span><span class='va'>strip_idx</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>
        <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>rows</span><span class='op'>[</span><span class='va'>rows_idxs</span><span class='op'>]</span><span class='op'>)</span>, 
        ncol <span class='op'>=</span> <span class='fl'>9</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span>
      <span class='op'>)</span>
    <span class='op'>}</span>
    <span class='co'># Print message every 1000 attempts</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>attempts</span> <span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span> <span class='fl'>1000</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"Attempt "</span>, <span class='va'>attempts</span>, <span class='st'>" | Strips built:"</span>, <span class='va'>strip_idx</span>, <span class='st'>"\n"</span><span class='op'>)</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  <span class='va'>dups</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>strips</span><span class='op'>)</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"There are "</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dups</span><span class='op'>)</span>, <span class='st'>" duplicatd layouts.\n"</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>strips</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h3 id="a-last-but-not-least-step">A last but not least step</h3>
<p>I’ve never seen a bingo game where you are given empty layouts and are asked to put numbers yourself. So let’s wrap this up and fill our empty cards!</p>
<p><code>fill_strips()</code> receives the strip layouts we generated, randomly selects <code>n</code> of them, and, also randomly, fills the slots the cards with numbers. Of course, the first column contains numbers from 1 to 9, the second column contains numbers from 10 to 19… and so on until the last column, that has numbers from 80 to 90.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fill_strips</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>strips</span>, <span class='va'>n</span> <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># Numbers that go in each column</span>
  <span class='va'>numbers</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>9</span>, <span class='fl'>10</span><span class='op'>:</span><span class='fl'>19</span>, <span class='fl'>20</span><span class='op'>:</span><span class='fl'>29</span>, <span class='fl'>30</span><span class='op'>:</span><span class='fl'>39</span>, <span class='fl'>40</span><span class='op'>:</span><span class='fl'>49</span>, <span class='fl'>50</span><span class='op'>:</span><span class='fl'>59</span>, <span class='fl'>60</span><span class='op'>:</span><span class='fl'>69</span>, <span class='fl'>70</span><span class='op'>:</span><span class='fl'>79</span>, <span class='fl'>80</span><span class='op'>:</span><span class='fl'>90</span><span class='op'>)</span>
  <span class='co'># Row indexes corresponding to each card in the strip</span>
  <span class='va'>card_rows</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>4</span><span class='op'>:</span><span class='fl'>6</span>, <span class='fl'>7</span><span class='op'>:</span><span class='fl'>9</span>, <span class='fl'>10</span><span class='op'>:</span><span class='fl'>12</span>, <span class='fl'>13</span><span class='op'>:</span><span class='fl'>15</span>, <span class='fl'>16</span><span class='op'>:</span><span class='fl'>18</span><span class='op'>)</span>
  
  <span class='va'>fill_strip</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>strip</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='co'># Put numbers in the slots with a 1 (meaning they must contain a number)</span>
    <span class='va'>strip</span><span class='op'>[</span><span class='va'>strip</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span>
      <span class='co'># This `sample()` reorders the numbers in each column randomly</span>
      <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span><span class='va'>sample</span>, <span class='va'>numbers</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>numbers</span>, <span class='va'>length</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>)</span>
    
    <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>card_rows</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>strip_</span> <span class='op'>=</span> <span class='va'>strip</span><span class='op'>[</span><span class='va'>card_rows</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>, <span class='op'>]</span>
      <span class='co'># Numbers in a given column are sorted in ascending order within cards</span>
      <span class='va'>x</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>strip_</span><span class='op'>)</span>
      <span class='va'>strip_</span><span class='op'>[</span><span class='va'>strip_</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span><span class='va'>x</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>]</span>
      <span class='va'>strip</span><span class='op'>[</span><span class='va'>card_rows</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>, <span class='op'>]</span> <span class='op'>=</span> <span class='va'>strip_</span>
    <span class='op'>}</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>strip</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='co'># Strip layouts can be repeated</span>
  <span class='va'>strips</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>strips</span>, <span class='va'>n</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>, <span class='va'>fill_strip</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='st'>"There are "</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>strips</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>" duplicated strips.\n"</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>strips</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>And we finally get our bingo strips :)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>0303456</span><span class='op'>)</span>
<span class='va'>rows</span> <span class='op'>=</span> <span class='fu'>get_rows</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>cards</span> <span class='op'>=</span> <span class='fu'>get_cards</span><span class='op'>(</span><span class='va'>rows</span>, <span class='fl'>1000</span><span class='op'>)</span>
<span class='va'>strips</span> <span class='op'>=</span> <span class='fu'>get_strips</span><span class='op'>(</span><span class='va'>cards</span>, <span class='va'>rows</span>, <span class='fl'>20</span><span class='op'>)</span>
<span class='va'>strips</span> <span class='op'>=</span> <span class='fu'>fill_strips</span><span class='op'>(</span><span class='va'>strips</span>, <span class='fl'>50</span><span class='op'>)</span>
<span class='co'># Output messages have been suppressed</span>
</code></pre>
</div>
</div>
<p>Let’s check some of them</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>strips</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
 [1,]    0   11   20    0   48    0    0   74   80
 [2,]    8    0    0   31    0   51   60   78    0
 [3,]    0   19   27   39    0   54   62    0    0
 [4,]    1    0   26    0   42   55    0    0   84
 [5,]    2   14    0   34    0    0   65   77    0
 [6,]    0   17   29    0   43   59    0    0   89
 [7,]    0    0   22   33    0    0   64   75   88
 [8,]    0   15    0   35   45    0    0   79   90
 [9,]    9    0   25    0   49   50   66    0    0
[10,]    3    0   28   30    0    0   61   71    0
[11,]    7    0    0   36   40   58    0    0   81
[12,]    0   10    0    0   44    0   63   76   87
[13,]    0    0   21   37    0   52   68   70    0
[14,]    5   16    0    0   41    0    0   72   82
[15,]    0   18    0   38   47   57    0    0   86
[16,]    0    0   23    0   46   53    0   73   83
[17,]    4   12    0   32    0    0   67    0   85
[18,]    6   13   24    0    0   56   69    0    0</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>strips</span><span class='op'>[[</span><span class='fl'>30</span><span class='op'>]</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
 [1,]    0    0   25    0   43   50    0   74   80
 [2,]    0   16   26   34    0    0   65   79    0
 [3,]    6   17    0   38    0   58    0    0   86
 [4,]    3    0   27    0   40   51   61    0    0
 [5,]    4    0    0   32   49   59    0    0   81
 [6,]    0   19   29   35    0    0   68   71    0
 [7,]    1   14    0    0   47    0   60   75    0
 [8,]    2    0   20   31    0    0   66    0   83
 [9,]    0    0   24    0   48   55    0   77   89
[10,]    0    0   28   33   42    0   64   76    0
[11,]    5   12    0   39    0    0   67    0   84
[12,]    9   15    0    0   45   54    0    0   87
[13,]    0   13   21    0    0   52    0   73   85
[14,]    0   18   22    0   44    0   63   78    0
[15,]    8    0    0   37   46   56    0    0   90
[16,]    0    0   23   30    0   53   62    0   82
[17,]    7   10    0   36    0    0   69   70    0
[18,]    0   11    0    0   41   57    0   72   88</code></pre>
</div>
<h2 id="are-we-going-to-play-on-r-consoles">Are we going to play on R consoles?</h2>
<p>All we got so far are matrices that <em>look like</em> a bingo strip. But honestly, without any given context, they just look like a bunch of matrices of the same dimension filled with 0s and other integer numbers. Our last task is to generate a .pdf output where these matrices really look like bingo cards.</p>
<p>In this last part of the post we make use of the <code>grid</code> package. For those who haven’t heard of it, it is the low level plotting library behind <code>ggplot2</code>, for example.</p>
<p>Here we have a little function, <code>make_grid()</code>, that given a number of rows and columns returns the <em>natural parent coordinates</em> of the borders the grid that defines the rectangles within each card.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>make_grid</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>rows</span>, <span class='va'>cols</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>lines_rows</span> <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='va'>rows</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>rows</span>, <span class='st'>"npc"</span><span class='op'>)</span>
  <span class='va'>lines_cols</span> <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='va'>cols</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>cols</span>, <span class='st'>"npc"</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"row"</span> <span class='op'>=</span> <span class='va'>lines_rows</span>, <span class='st'>"col"</span> <span class='op'>=</span> <span class='va'>lines_cols</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>And now we have the main function used to plot the bingo strips. Since the function is quite large, I prefer to explain how it works with comments in the body.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plot_strips</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>strips</span>, <span class='va'>col</span> <span class='op'>=</span> <span class='st'>"#8e44ad"</span>, <span class='va'>width_row</span> <span class='op'>=</span> <span class='fl'>0.925</span>, 
                       <span class='va'>width_col</span> <span class='op'>=</span> <span class='fl'>0.975</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='co'># `rows` and `cols` are the dimensions of each card</span>
  <span class='va'>rows</span> <span class='op'>=</span> <span class='fl'>3</span>
  <span class='va'>cols</span> <span class='op'>=</span> <span class='fl'>9</span>
  <span class='va'>g</span> <span class='op'>=</span> <span class='fu'>make_grid</span><span class='op'>(</span><span class='va'>rows</span>, <span class='va'>cols</span><span class='op'>)</span>
  <span class='co'># Compute the center of each square in the card grid</span>
  <span class='va'>centers_rows</span> <span class='op'>=</span> <span class='va'>g</span><span class='op'>$</span><span class='va'>row</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>rows</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>)</span>, <span class='st'>"npc"</span><span class='op'>)</span>
  <span class='va'>centers_cols</span> <span class='op'>=</span> <span class='va'>g</span><span class='op'>$</span><span class='va'>col</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>cols</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>)</span>, <span class='st'>"npc"</span><span class='op'>)</span>
  <span class='co'># Sort the centers appropiately</span>
  <span class='co'># This is required because of how we loop over the values in each card</span>
  <span class='va'>x_coords</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>centers_cols</span>, each <span class='op'>=</span> <span class='va'>rows</span><span class='op'>)</span>
  <span class='va'>y_coords</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>centers_rows</span><span class='op'>)</span>, <span class='va'>cols</span><span class='op'>)</span>
  
  <span class='co'># Create unique identifiers for the cards</span>
  <span class='va'>cards_n</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"CARD N"</span>, <span class='fu'><a href='https://rdrr.io/r/base/utf8Conversion.html'>intToUtf8</a></span><span class='op'>(</span><span class='fl'>176</span><span class='op'>)</span><span class='op'>)</span>, 
                  <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>strips</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span>
  <span class='co'># Compute the number of sheets we're going to need. </span>
  <span class='co'># Each sheet contains two strips</span>
  <span class='va'>sheets_n</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>ceiling</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>strips</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span>
  
  <span class='co'># Initial numbers</span>
  <span class='va'>card_idx</span> <span class='op'>=</span> <span class='fl'>0</span>
  <span class='va'>strip_idx</span> <span class='op'>=</span> <span class='fl'>0</span>
  
  <span class='co'># Loop over sheets</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>sheet_idx</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>sheets_n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='co'># Each sheet is a grid of 6 rows and 3 columns. </span>
    <span class='co'># Columns 1 and 3 are where we place the strips. </span>
    <span class='co'># Column 2 just gives vertical separation.</span>
    <span class='va'>l</span> <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.layout.html'>grid.layout</a></span><span class='op'>(</span>nrow <span class='op'>=</span> <span class='fl'>6</span>, ncol <span class='op'>=</span> <span class='fl'>3</span>, 
                          widths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>48.75</span>, <span class='fl'>2.5</span> <span class='op'>+</span> <span class='fl'>3.75</span>, <span class='fl'>48.75</span><span class='op'>)</span><span class='op'>)</span>
    <span class='co'># Start a new page filled with white</span>
    <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.newpage.html'>grid.newpage</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.rect.html'>grid.rect</a></span><span class='op'>(</span>gp <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='cn'>NULL</span>, fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span><span class='op'>)</span>
    
    <span class='va'>vp_mid</span> <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewport.html'>viewport</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span>, <span class='va'>width_row</span>, <span class='va'>width_col</span>, layout <span class='op'>=</span> <span class='va'>l</span><span class='op'>)</span>
    <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewports.html'>pushViewport</a></span><span class='op'>(</span><span class='va'>vp_mid</span><span class='op'>)</span>
    
    <span class='co'># Loop over columns 1 and 3</span>
    <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='co'># Select strip</span>
      <span class='va'>strip_idx</span> <span class='op'>=</span> <span class='va'>strip_idx</span> <span class='op'>+</span> <span class='fl'>1</span>
      <span class='kw'>if</span> <span class='op'>(</span><span class='va'>strip_idx</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>strips</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'>break</span>
      <span class='va'>strip</span> <span class='op'>=</span> <span class='va'>strips</span><span class='op'>[[</span><span class='va'>strip_idx</span><span class='op'>]</span><span class='op'>]</span>
      
      <span class='co'># Loop over rows (these rows represent the 6 rows assigned to cards)</span>
      <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1L</span><span class='op'>:</span><span class='va'>l</span><span class='op'>$</span><span class='va'>nrow</span><span class='op'>)</span> <span class='op'>{</span>
        <span class='va'>card_idx</span> <span class='op'>=</span> <span class='va'>card_idx</span> <span class='op'>+</span> <span class='fl'>1</span>
        <span class='va'>vp_inner</span> <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewport.html'>viewport</a></span><span class='op'>(</span>layout.pos.row <span class='op'>=</span> <span class='va'>i</span>, layout.pos.col <span class='op'>=</span> <span class='va'>j</span><span class='op'>)</span>
        <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewports.html'>pushViewport</a></span><span class='op'>(</span><span class='va'>vp_inner</span><span class='op'>)</span>
        
        <span class='co'># Add card identification number on top-left</span>
        <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.text.html'>grid.text</a></span><span class='op'>(</span>
          label <span class='op'>=</span> <span class='va'>cards_n</span><span class='op'>[</span><span class='va'>card_idx</span><span class='op'>]</span>,
          x <span class='op'>=</span> <span class='fl'>0</span>,
          y <span class='op'>=</span> <span class='fl'>0.96</span>,
          just <span class='op'>=</span> <span class='st'>"left"</span>,
          gp <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>fontsize <span class='op'>=</span> <span class='fl'>9</span><span class='op'>)</span>
        <span class='op'>)</span>
        
        <span class='co'># Draw a grill that separates the slots in the card</span>
        <span class='va'>vp_mid_inner</span> <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewport.html'>viewport</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>0.80</span><span class='op'>)</span>
        <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewports.html'>pushViewport</a></span><span class='op'>(</span><span class='va'>vp_mid_inner</span><span class='op'>)</span>
        <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.grill.html'>grid.grill</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='va'>g</span><span class='op'>$</span><span class='va'>row</span>,  v <span class='op'>=</span> <span class='va'>g</span><span class='op'>$</span><span class='va'>col</span>, gp <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='va'>col</span><span class='op'>)</span><span class='op'>)</span>
        
        <span class='co'># Select the numbers that correspond to this card</span>
        <span class='va'>numbers</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span><span class='op'>(</span><span class='va'>strip</span><span class='op'>[</span><span class='op'>(</span><span class='fl'>3</span> <span class='op'>*</span> <span class='va'>i</span> <span class='op'>-</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='fl'>3</span> <span class='op'>*</span> <span class='va'>i</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span>
        <span class='co'># Logical vector that indicates which rectangles are filled</span>
        <span class='co'># with nunumbers and which rectangles are empty</span>
        <span class='va'>lgl</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>numbers</span> <span class='op'>==</span> <span class='fl'>0</span>, <span class='cn'>FALSE</span>, <span class='cn'>TRUE</span><span class='op'>)</span>
        
        <span class='co'># Draw the numbers in positions given by the rectangle centers</span>
        <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.text.html'>grid.text</a></span><span class='op'>(</span>
          label <span class='op'>=</span> <span class='va'>numbers</span><span class='op'>[</span><span class='va'>lgl</span><span class='op'>]</span>,
          x <span class='op'>=</span> <span class='va'>x_coords</span><span class='op'>[</span><span class='va'>lgl</span><span class='op'>]</span>,
          y <span class='op'>=</span> <span class='va'>y_coords</span><span class='op'>[</span><span class='va'>lgl</span><span class='op'>]</span>,
          gp <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>fontsize <span class='op'>=</span> <span class='fl'>18</span><span class='op'>)</span>
        <span class='op'>)</span>
        
        <span class='co'># Fill empty slots with color</span>
        <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/grid.rect.html'>grid.rect</a></span><span class='op'>(</span>
          x <span class='op'>=</span> <span class='va'>x_coords</span><span class='op'>[</span><span class='op'>!</span><span class='va'>lgl</span><span class='op'>]</span>,
          y <span class='op'>=</span> <span class='va'>y_coords</span><span class='op'>[</span><span class='op'>!</span><span class='va'>lgl</span><span class='op'>]</span>,
          height <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='va'>rows</span>, <span class='st'>"npc"</span><span class='op'>)</span>,
          width <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='va'>cols</span>, <span class='st'>"npc"</span><span class='op'>)</span>,
          gp <span class='op'>=</span> <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>
            col <span class='op'>=</span> <span class='cn'>NA</span>,
            fill <span class='op'>=</span> <span class='fu'>farver</span><span class='fu'>::</span><span class='fu'><a href='https://farver.data-imaginist.com/reference/encode_colour.html'>encode_colour</a></span><span class='op'>(</span><span class='fu'>farver</span><span class='fu'>::</span><span class='fu'><a href='https://farver.data-imaginist.com/reference/decode_colour.html'>decode_colour</a></span><span class='op'>(</span><span class='va'>col</span><span class='op'>)</span>, <span class='fl'>0.7</span><span class='op'>)</span>
          <span class='op'>)</span>
        <span class='op'>)</span>
        <span class='co'># End</span>
        <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewports.html'>popViewport</a></span><span class='op'>(</span><span class='op'>)</span>
        <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewports.html'>popViewport</a></span><span class='op'>(</span><span class='op'>)</span>
      <span class='op'>}</span>
    <span class='op'>}</span>
    <span class='fu'>grid</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grid/viewports.html'>popViewport</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Now, all we need is to pass the <code>strips</code> generated above to <code>plot_strips()</code> and wrap that call within <code>grDevices::pdf()</code> and <code>grDevices::dev.off()</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Height and width are in inches and here they correspond to legal paper size</span>
<span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span><span class='st'>"strips.pdf"</span>, height <span class='op'>=</span> <span class='fl'>14</span>, width <span class='op'>=</span> <span class='fl'>8.5</span><span class='op'>)</span>
<span class='fu'>plot_strips</span><span class='op'>(</span><span class='va'>strips</span><span class='op'>)</span>
<span class='fu'>grDevices</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>If it works, you’ll have a 25 pages pdf with bingo cards that look like this one</p>
<center>
<figure>
<img src="files/bingo_card_own.PNG" alt="First card in the output" /><figcaption aria-hidden="true">First card in the output</figcaption>
</figure>
</center>
<p>If you can’t (or just don’t want to) run the code, <a href="files/strips.pdf">here</a> you have the generated pdf.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>How I dare to call this a project?<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>But you should try this bingo, you gonna like it!<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>Some are also known as <em>sobremesa</em><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>Haven’t you heard <em>Estallando desde el océano</em> by Sumo?<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>If you’ve heard of Sampford’s pps sampling, this is going to be familiar<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>I know that returning row indexes is less intuitive than returning card layouts, but this approach requires less memory because it only stores 3 values per card, instead of 18.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>TomÃ¡s Capretto - Copyright <script>document.write(new Date().getFullYear())</script></p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
